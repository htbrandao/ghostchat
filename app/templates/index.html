{% extends "base.html" %}
{% block content %}

<div class="text-center mb-5">
    <h1 class="fw-bold">Create a secure chat</h1>
    <p class="text-muted"><b>Private</b> boards for <b>two people</b> with <b>1h lifetime</b></p>
</div>

<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card shadow-sm rounded-4">
            <div class="card-body p-4">
                <form method="post" action="/boards" id="createForm">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label">Chat Name</label>
                            <input type="text" class="form-control" name="name">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('createForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = new FormData(e.target);
        const payload = { name: form.get('name'), password: form.get('password') };
        const resp = await fetch('/boards', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
        const data = await resp.json();
        if(data.id){
            window.location = `/boards/${data.id}`;
        }
    });
</script>
{% endblock %}
